"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[292],{5292:function(e,t,r){r.r(t),r.d(t,{NestedAppAuthController:function(){return v}});var n,o=r(9566),i=r(177),c=r(2979),s=r(9569),a=r(6516),u=r(6831),d=r(4228),p=r(7752),h=r(2111),l=r(5152),A=r(536);
/*! @azure/msal-browser v3.3.0 2023-10-20 */
function E(e){return void 0!==e.status}(function(e){e["USER_INTERACTION_REQUIRED"]="USER_INTERACTION_REQUIRED",e["USER_CANCEL"]="USER_CANCEL",e["NO_NETWORK"]="NO_NETWORK",e["TRANSIENT_ERROR"]="TRANSIENT_ERROR",e["PERSISTENT_ERROR"]="PERSISTENT_ERROR",e["DISABLED"]="DISABLED",e["ACCOUNT_UNAVAILABLE"]="ACCOUNT_UNAVAILABLE",e["NESTED_APP_AUTH_UNAVAILABLE"]="NESTED_APP_AUTH_UNAVAILABLE"})(n||(n={}));
/*! @azure/msal-browser v3.3.0 2023-10-20 */
class g{constructor(e,t,r,n){this.clientId=e,this.clientCapabilities=t,this.crypto=r,this.logger=n}toNaaSilentTokenRequest(e){let t;t=void 0===e.extraQueryParameters?new Map:new Map(Object.entries(e.extraQueryParameters));const r={userObjectId:e.account?.homeAccountId,clientId:this.clientId,authority:e.authority,scope:e.scopes.join(" "),correlationId:void 0!==e.correlationId?e.correlationId:this.crypto.createNewGuid(),prompt:void 0!==e.prompt?e.prompt:"",claims:void 0!==e.claims?e.claims:"",authenticationScheme:void 0!==e.authenticationScheme?e.authenticationScheme:"",clientCapabilities:this.clientCapabilities,extraParameters:t};return r}toNaaTokenRequest(e){let t;t=void 0===e.extraQueryParameters?new Map:new Map(Object.entries(e.extraQueryParameters));const r={userObjectId:e.account?.homeAccountId,clientId:this.clientId,authority:e.authority,scope:e.scopes.join(" "),correlationId:void 0!==e.correlationId?e.correlationId:"",prompt:void 0!==e.prompt?e.prompt:"",nonce:void 0!==e.nonce?e.nonce:"",claims:void 0!==e.claims?e.claims:"",state:void 0!==e.state?e.state:"",authenticationScheme:void 0!==e.authenticationScheme?e.authenticationScheme:"",clientCapabilities:void 0,extraParameters:t};return r}fromNaaTokenResponse(e,t){const r=new Date(a.I.nowSeconds()+1e3*(t.expires_in||0)),n=this.fromNaaAccountInfo(t.account),o={authority:t.account.environment,uniqueId:t.account.homeAccountId,tenantId:t.account.tenantId,scopes:t.scope.split(" "),account:this.fromNaaAccountInfo(t.account),idToken:void 0!==t.id_token?t.id_token:"",idTokenClaims:void 0!==n.idTokenClaims?n.idTokenClaims:{},accessToken:t.access_token,fromCache:!0,expiresOn:r,tokenType:void 0!==e.authenticationScheme?e.authenticationScheme:"Bearer",correlationId:e.correlationId,requestId:"",extExpiresOn:r,state:t.state};return o}fromNaaAccountInfo(e){let t;t=void 0!==e.idToken?u.Z_(e.idToken,this.crypto.base64Decode):void 0;const r={homeAccountId:e.homeAccountId,environment:e.environment,tenantId:e.tenantId,username:e.username,localAccountId:e.localAccountId,name:e.name,idToken:e.idToken,idTokenClaims:t};return r}fromBridgeError(e){if(!E(e))return new A.l4("unknown_error","An unknown error occurred");switch(e.status){case n.USER_CANCEL:return new d.er(p.userCanceled);case n.NO_NETWORK:return new d.er(p.noNetworkConnectivity);case n.ACCOUNT_UNAVAILABLE:return new d.er(p.noAccountFound);case n.DISABLED:return new d.er(p.nestedAppAuthBridgeDisabled);case n.NESTED_APP_AUTH_UNAVAILABLE:return new d.er(e.code,e.description);case n.TRANSIENT_ERROR:case n.PERSISTENT_ERROR:return new h.n(e.code,e.description);case n.USER_INTERACTION_REQUIRED:return new l.Yo(e.code,e.description);default:return new A.l4(e.code,e.description)}}}
/*! @azure/msal-browser v3.3.0 2023-10-20 */
const m={unsupportedMethod:{code:"unsupported_method",desc:"The PKCE code challenge and verifier could not be generated."}};class I extends A.l4{constructor(e,t){super(e,t),Object.setPrototypeOf(this,I.prototype),this.name="NestedAppAuthError"}static createUnsupportedError(){return new I(m.unsupportedMethod.code,m.unsupportedMethod.desc)}}var C=r(8896),T=r(882);
/*! @azure/msal-browser v3.3.0 2023-10-20 */
class v{constructor(e){this.operatingContext=e;const t=this.operatingContext.getBridgeProxy();if(void 0===t)throw new Error("unexpected: bridgeProxy is undefined");this.bridgeProxy=t,this.config=e.getConfig(),this.logger=this.operatingContext.getLogger(),this.performanceClient=this.config.telemetry.client,this.browserCrypto=e.isBrowserEnvironment()?new s.Q(this.logger,this.performanceClient):o.d,this.eventHandler=new C.b(this.logger,this.browserCrypto),this.nestedAppAuthAdapter=new g(this.config.auth.clientId,this.config.auth.clientCapabilities,this.browserCrypto,this.logger)}getBrowserStorage(){throw I.createUnsupportedError()}getEventHandler(){return this.eventHandler}static async createController(e){const t=new v(e);return Promise.resolve(t)}initialize(){return Promise.resolve()}async acquireTokenInteractive(e){this.eventHandler.emitEvent(T.t.ACQUIRE_TOKEN_START,c.s_.Popup,e);const t=this.performanceClient.startMeasurement(i.Ak.AcquireTokenPopup,e.correlationId);t?.add({nestedAppAuthRequest:!0});try{const r=this.nestedAppAuthAdapter.toNaaTokenRequest(e),n=await this.bridgeProxy.getTokenInteractive(r),o=this.nestedAppAuthAdapter.fromNaaTokenResponse(r,n);return this.operatingContext.setActiveAccount(o.account),this.eventHandler.emitEvent(T.t.ACQUIRE_TOKEN_SUCCESS,c.s_.Popup,o),t.add({accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length}),t.end({success:!0,requestId:o.requestId}),o}catch(r){const e=this.nestedAppAuthAdapter.fromBridgeError(r);throw this.eventHandler.emitEvent(T.t.ACQUIRE_TOKEN_FAILURE,c.s_.Popup,null,r),t.end({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}}async acquireTokenSilentInternal(e){this.eventHandler.emitEvent(T.t.ACQUIRE_TOKEN_START,c.s_.Silent,e);const t=this.performanceClient.startMeasurement(i.Ak.SsoSilent,e.correlationId);t?.increment({visibilityChangeCount:0}),t?.add({nestedAppAuthRequest:!0});try{const r=this.nestedAppAuthAdapter.toNaaSilentTokenRequest(e),n=await this.bridgeProxy.getTokenSilent(r),o=this.nestedAppAuthAdapter.fromNaaTokenResponse(r,n);return this.operatingContext.setActiveAccount(o.account),this.eventHandler.emitEvent(T.t.ACQUIRE_TOKEN_SUCCESS,c.s_.Silent,o),t?.add({accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length}),t?.end({success:!0,requestId:o.requestId}),o}catch(r){const e=this.nestedAppAuthAdapter.fromBridgeError(r);throw this.eventHandler.emitEvent(T.t.ACQUIRE_TOKEN_FAILURE,c.s_.Silent,null,r),t?.end({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}}async acquireTokenPopup(e){return this.acquireTokenInteractive(e)}acquireTokenRedirect(e){throw I.createUnsupportedError()}async acquireTokenSilent(e){return this.acquireTokenSilentInternal(e)}acquireTokenByCode(e){throw I.createUnsupportedError()}acquireTokenNative(e,t,r){throw I.createUnsupportedError()}acquireTokenByRefreshToken(e,t){throw I.createUnsupportedError()}addEventCallback(e){return this.eventHandler.addEventCallback(e)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){throw I.createUnsupportedError()}removePerformanceCallback(e){throw I.createUnsupportedError()}enableAccountStorageEvents(){throw I.createUnsupportedError()}disableAccountStorageEvents(){throw I.createUnsupportedError()}getAccount(e){throw I.createUnsupportedError()}getAccountByHomeId(e){const t=this.operatingContext.getActiveAccount();return void 0!==t&&t.homeAccountId===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}getAccountByLocalId(e){const t=this.operatingContext.getActiveAccount();return void 0!==t&&t.localAccountId===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}getAccountByUsername(e){const t=this.operatingContext.getActiveAccount();return void 0!==t&&t.username===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}getAllAccounts(){const e=this.operatingContext.getActiveAccount();return void 0!==e?[this.nestedAppAuthAdapter.fromNaaAccountInfo(e)]:[]}handleRedirectPromise(e){throw I.createUnsupportedError()}loginPopup(e){if(void 0!==e)return this.acquireTokenInteractive(e);throw I.createUnsupportedError()}loginRedirect(e){throw I.createUnsupportedError()}logout(e){throw I.createUnsupportedError()}logoutRedirect(e){throw I.createUnsupportedError()}logoutPopup(e){throw I.createUnsupportedError()}ssoSilent(e){return this.acquireTokenSilentInternal(e)}getTokenCache(){throw I.createUnsupportedError()}getLogger(){return this.logger}setLogger(e){this.logger=e}setActiveAccount(e){this.logger.warning("nestedAppAuth does not support setActiveAccount")}getActiveAccount(){const e=this.operatingContext.getActiveAccount();return void 0!==e?this.nestedAppAuthAdapter.fromNaaAccountInfo(e):null}initializeWrapperLibrary(e,t){}setNavigationClient(e){this.logger.warning("setNavigationClient is not supported in nested app auth")}getConfiguration(){return this.config}isBrowserEnv(){return this.operatingContext.isBrowserEnvironment()}getBrowserCrypto(){return this.browserCrypto}getPerformanceClient(){throw I.createUnsupportedError()}getRedirectResponse(){throw I.createUnsupportedError()}preflightBrowserEnvironmentCheck(e,t){throw I.createUnsupportedError()}async clearCache(e){throw I.createUnsupportedError()}async hydrateCache(e,t){throw I.createUnsupportedError()}}}}]);
//# sourceMappingURL=292.5f97e92d.js.map